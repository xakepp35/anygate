# GOVERNANCE.md

## Назначение и область

Этот документ определяет, как управляется проект AnyGate: роли, порядок принятия решений, правила совместимости и релизов, а также как изменения попадают в кодовую базу. Распространяется на исходный код, документацию, сборочные конвейеры, публикуемые артефакты и трекеры задач.

## Ценности проекта

* Производительность прежде всего, минимальная поверхность, предсказуемый «горячий путь».
* Обратная совместимость пользовательского DSL и конфигурации — по умолчанию.
* Безопасность по проекту: наименьшие привилегии, явные фичи, отсутствие скрытой магии.
* Понятная документация, воспроизводимые сборки, наблюдаемость поведения.

## Роли

* **Контрибьюторы** — любые участники, создающие issue/PR.
* **Ревьюеры** — контрибьюторы с правами ревью в конкретных областях.
* **Мейнтейнеры** — перечислены в `MAINTAINERS.md`; могут одобрять/сливать; владеют зонами через `CODEOWNERS`.
* **Релиз-менеджер** — назначается на релиз; ведёт фриз, теги и заметки.
* **Команда безопасности** — перечислена в `SECURITY.md`; обрабатывает приватные отчёты, эмбарго и консультации.
* **Технический комитет (TSC, Technical Steering Committee)** — подмножество мейнтейнеров по ключевым областям (рантайм, роутер/DSL, действия/прокси, безопасность). Разрешает эскалации и владеет межсрезовыми политиками.

Один человек может совмещать несколько ролей. Изменения состава — через PR, одобренный TSC.

## Принятие решений

* **«Ленивая» консенсусная модель** в issue и PR: при отсутствии обоснованных возражений после ревью изменение принимается.
* **Эскалация до голосования**, если консенсуса нет: простое большинство участвующих мейнтейнеров; председатель TSC решает при равенстве.
* **Блокирующие возражения** допустимы только с технической аргументацией, ссылающейся на Ценности/Scope/Безопасность.

## Изменения, требующие RFC

Обязателен процесс RFC для:

* Грамматики DSL или семантики матчинга.
* Публичной схемы конфигурации и дефолтного поведения.
* Контракта плагинов и жизненного цикла фильтров.
* Изменений проводов/протоколов, модели ввода-вывода рантайма или потоковой модели.
* Таксономии наблюдаемости (имена/лейблы метрик, формат логов, атрибуты трейсинга).
* Депрекейшенов и удалений; feature-gate для экспериментальных возможностей.
* Безопасностно-чувствительных изменений (политика TLS/mTLS, обращение с ключами, динамические плагины).
* Поправок в управлении/процессах.

### Процесс RFC

1. Открыть `rfcs/NNNN-title.md` (есть шаблон) и связанный трекинг-issue.
2. Обсуждение в PR; ревью мейнтейнеров и TSC.
3. Объявление финального периода комментариев (FCP) в PR.
4. Фиксация решения с обоснованием; пометка issue как `accepted` или `rejected`.
5. Реализационные PR ссылаются на RFC и закрывают трекинг-issue при слиянии.

## Версионирование и совместимость

* **SemVer** для тегов `vX.Y.Z`.
* **MAJOR** — ломающие изменения DSL/конфига или публичных API; требуют RFC и заметок по миграции.
* **MINOR** — новые функции без ломаний; допускается включение через feature-флаги.
* **PATCH** — исправления ошибок/безопасности; без поведенческих изменений сверх корректировок.

Депрекейшены должны включать обоснование, замену, примеры и план удаления. Бэкпорты: исправления безопасности и критической корректности — в последнюю стабильную линию и предыдущую минорную, когда возможно.

## Владение кодом и ревью

* `CODEOWNERS` сопоставляет критические пути владельцам; изменения в этих зонах требуют их ревью.
* Обязательные проверки: форматирование, линт, тесты, сканы безопасности; отсутствие деградаций производительности относительно поддерживаемых базовых профилей в горячих путях.
* Крупные или поперечные изменения разбиваются на обозреваемые инкременты.

## Релизы

* Ветки: `main` (разработка), `release-X.Y` (стабилизация).
* На каждый релиз назначается релиз-менеджер, который:

  * объявляет окно фриза,
  * готовит changelog и благодарности,
  * координируется с Командой безопасности по советам/адвайзори,
  * подписывает теги и артефакты.

## Безопасность

* Приватные каналы для отчётов и PGP-ключи указаны в `SECURITY.md`.
* Исправления под эмбарго координируются Командой безопасности и релиз-менеджером.
* Публикации адвайзори следуют политике согласованного раскрытия.

## Активы и доступ

* Организация в VCS, реестры пакетов/контейнеров — активы проекта.
* Доступы — по принципу наименьших привилегий; для чувствительных изменений (секреты, ключи подписи) — правило «двух пар глаз».
* Ротация ключей и обработка инцидентов следуют `SECURITY.md`.

## Изменения правил управления

Поправки к этому документу требуют RFC и одобрения TSC. В коммит-сообщении должна быть ссылка на обсуждение и обоснование.
