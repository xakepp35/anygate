# SECURITY.md

## Обзор

Здесь описано: как сообщать об уязвимостях, как проект реагирует, какие версии поддерживаются исправлениями, и какие меры харденинга рекомендуются при эксплуатации AnyGate.

## Как сообщить об уязвимости

* Электронная почта: `security@anygate.dev`
* PGP: открытый ключ в `SECURITY-KEYS.asc` (отпечаток указан там)
* Дополнительно: `.well-known/security.txt` на сайте проекта с теми же контактами

Пожалуйста, **укажите**:

* Чёткое описание, затронутые компоненты/версии и шаги воспроизведения.
* Оценку воздействия (конфиденциальность/целостность/доступность), если известно.
* Предпочитаете ли публичное упоминание в адвайзори.

Не создавайте публичные issue о непатченных уязвимостях — используйте приватный канал.

## «Безопасная гавань» для исследователей

Мы приветствуем добросовестные исследования. Избегайте утечек данных, нарушений сервисов или приватности. Тестируйте на своих развёртываниях; для общих сред получите разрешение. Добросовестные отчёты, следующие этим правилам, не преследуются.

## Процесс раскрытия

1. **Триаж:** подтверждение получения, проверка области и серьёзности.
2. **Назначение:** Команда безопасности назначает ответственного; координация с мейнтейнерами.
3. **Исправление:** подготовка патча, тестов и заметок по харденингу; подготовка бэкпортов.
4. **Адвайзори:** подготовка уведомления с запросом CVE (если применимо); согласование окна эмбарго с репортёром.
5. **Релиз:** публикация исправленных версий, подписанных тегов/артефактов; публикация адвайзори; благодарность репортёру (если не отказался).
6. **Постмортем:** фиксация корневой причины и улучшений процесса/харденинга.

Мы стремимся оперативно подтверждать отчёты и согласовывать сроки, балансируя безопасность пользователей и предпочтения репортёра.

## Область действия

Включено:

* Ядро рантайма и сетевой код.
* Роутер/DSL, действия (fixed, echo, static, proxy), встроенные плагины.
* Обработка конфигурации TLS/mTLS и использование ключей.
* Инсталляторы, релизные артефакты и контейнерные образы, публикуемые проектом.

Исключено:

* Уязвимости сторонних зависимостей, не эксплуатируемые через использование AnyGate. Мы отслеживаем адвайзори и обновляемся без промедления.
* Ошибки конфигурации развёртываний (недостаточный харденинг ОС, открытые административные сети).
* Волуметрические атаки на L3/L4 и проблемы у провайдеров.
* Социнженерия, фишинг и атаки вне кодовой базы.
* Старые, неподдерживаемые версии (см. ниже).

## Поддерживаемые версии

* Последняя стабильная релизная линия.
* Предыдущая минорная линия — для критических и безопасностных исправлений, когда возможно.

Более старые версии могут получать помощь сообщества «по возможности», но без гарантий исправлений.

## Рекомендации по харденингу (операторы)

* Запуск от непривилегированного пользователя; включайте chroot/static-root при необходимости.
* Ограничивайте размеры заголовков/тел, применяйте таймауты и rate-limit по ситуации.
* Современные настройки TLS; включайте mTLS на уровне маршрутов/групп для чувствительных бекендов.
* Отключайте динамические плагины в продакшене, если они не строго необходимы; проверяйте конфигурации.
* Изолируйте доступ к файловой системе для статики; подключайте тома только на чтение.
* Обеспечьте наблюдаемость: экспорт метрик/трейсов/логов; алерты на рост ошибок и аномальные задержки.
* Обновляйте ОС и libc; применяйте сетевой харденинг ядра согласно поставляемым гайдам.

## Цепочка поставки и целостность сборок

* Нацеливаемся на воспроизводимые сборки; lockfile фиксируется в репозитории.
* Релизные теги и артефакты **подписываются**; инструкции по проверке включаются в релизы.
* С каждой версией публикуется SBOM; сканы зависимостей запускаются в CI.
* Секреты и ключи подписи хранятся с аппаратной защитой, где возможно; ротация документирована.

## Классификация уязвимостей

Приоритизация учитывает:

* Дистанционное выполнение кода до авторизации, повреждения памяти или выход из «песочницы».
* Обход аутентификации/авторизации.
* Раскрытие информации (ключи, токены, чувствительные заголовки).
* Отказ в обслуживании в горячих путях, доступных без авторизации.
* Ошибки разбора конфигураций, позволяющие обходить политики.

Для оценки серьёзности применяются общепринятые методики; это помогает расставлять приоритеты фиксов и бэкпортов.

## Что не квалифицируется

* Рекомендации «лучших практик» без конкретной уязвимости.
* Отчёты о сторонних сервисах или инфраструктуре вне контроля проекта.
* Брутфорс/credential stuffing против демо/тестовых эндпойнтов.
* Сообщения от инструментов с «общими» выводами без доказуемой эксплуатируемости.

Такие вопросы могут повлиять на документацию или гайды по харденингу и приветствуются как обычные issue.

## Координация с downstream

Если отчёт затрагивает производные дистрибуции или крупных интеграторов, Команда безопасности может предварительно уведомить доверенных контактов под эмбарго для подготовки патчей и планов раскатки.

## Контакты и ключи

* Основной контакт: `security@anygate.dev`
* Резервный контакт: `maintainers@anygate.dev`
* Открытые PGP-ключи: `SECURITY-KEYS.asc` (регулярная ротация; старые ключи отзываются и хранятся для истории проверки)

## Поправки

Изменения политики безопасности вносятся через RFC или отдельный PR, ревью Команды безопасности и TSC; в коммите фиксируется обоснование и ссылки на обсуждение.
