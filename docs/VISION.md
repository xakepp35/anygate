# AnyGate — Product Vision

## Резюме для C-level

AnyGate — единый сверхпроизводительный reverse-proxy и сервер статики с декларативным DSL «в одну строку». Он объединяет роли nginx/traefik/HAProxy для веб-приложений, API и SPA-фронтов, сокращая инфраструктурный след, ускоряя вывод релизов и снимая операционные риски. Лицензия MIT обеспечивает нулевую стоимость владения и отсутствие vendor lock-in. Ядро на Rust с собственным асинхронным рантаймом по умолчанию (epoll), совместимость с экосистемой tokio опционально (возможна реализация на осснове tokio в MVP но для обесспечения нишевыых целей продукту важнен собсственный самописный рантайм).

## Почему миру это нужно сегодня

* **Взрывной рост микросервисов бекенда и микрофронтов:** слишком много разных прокси под разные задачи → фрагментация, ошибки, рост стоимости владения TCO.
* **Разрыв Dev ↔ Prod:** разные конфиги и поведение на окружениях, сложные пайплайны.
* **Требование к латентности и экономии:** каждая миллисекунда и каждый ватт дают конкурентное преимущество.
* **Безопасность поставок:** нужен минималистичный, прозрачный, воспроизводимый стек с понятной лицензией.
* **Стандартизация конфигов:** бизнесу важна переносимость, наблюдаемость и единые практики.

## Видение

Сделать AnyGate новым промышленным стандартом уровня «по умолчанию» для доставки веб-продуктов и API: один бинарь, один читаемый конфиг, любые сценарии — от статики SPA до высоконагруженного проксирования — без потери производительности и управляемости.

## Стратегические ставки

* **Единство:** статика, прокси, mock/echo и плагины — в одном продукте и одном DSL.
* **Производительность по умолчанию:** горячие пути без виртуализации, zero-copy, sendfile/mmap, тонкие сети.
* **Надёжность и наблюдаемость:** предсказуемые лимиты, backpressure, понятные логи и метрики.
* **Открытость:** MIT, прозрачный roadmap, совместимость и расширяемость без компромиссов по перформансу.

## Продуктовые столпы

* **Сверхпроизводительное ядро:** собственный реактор на epoll, планировщик, пулы буферов, hot-reload без обрывов.
* **Простой и выразительный DSL:** маршруты в одну строку, методы, параметры пути, splat, быстрые fixed/echo.
* **Сервер статики уровня платформы:** sendfile/mmap, ETag/Last-Modified, range, SPA-fallback, компрессия.
* **Reverse-proxy уровня платформы:** keep-alive, мультиплексирование, пулы коннектов, X-Forwarded/Forwarded, балансировка, retries, circuit-breaker.
* **Плагины без «магии»:** logger, rate-limit, headers, CORS, IP-фильтры, простая авторизация; динамика опционально.
* **Наблюдаемость и безопасность:** структурные логи, метрики Prometheus, трассировка, TLS/mTLS per-route, drop-privileges.

## Ключевые возможности для бизнеса

* **Сокращение TCO:** меньше компонентов, меньше образов, меньше областей поддержки.
* **Ускорение time-to-market:** SPA «из коробки» ("/": "/dist/"), mocks/echo для параллельной разработки, hot-reload конфигов без простоя.
* **Снижение рисков:** детерминированные лимиты, защита от медленных клиентов, единая политика TLS и заголовков.
* **Наблюдаемость:** метрики и логи единообразны по всем маршрутам, простой аудит изменений.
* **Гибкость внедрения:** drop-in замена на узлах, работа под непривилегированным пользователем, контейнер-френдли.

## Для кого и какая выгода

* **CEO/COO:** быстрее релизы, меньше инцидентов, стандарт по всей организации.
* **CTO/CIO:** унификация стека, контроль производительности, снижение технологического долга.
* **CFO:** экономия вычислительных и опер. затрат, снижение оплаты за избыточные ресурсы и лицензии.
* **CISO:** предсказуемая поверхность атаки, строгий TLS/mTLS, минимум внешних зависимостей.
* **CPO/Head of Product:** параллельная разработка через fixed/mock/echo, быстрые демо и предпрод. проверки.
* **SRE/Platform:** единая политика, меньше «зоопарка», обоснованный тюнинг и воспроизводимые бенчи.

## Дифференциаторы

* **Один DSL на всё:** прокси, статика, mock и диагностика — без разных синтаксисов и сервисов.
* **Производительность без компромиссов:** горячие пути инлайнены, без tower-подобных прослоек.
* **Стандарт «SPA в контейнере»:** простое правило `"/": "/dist/"` — и nginx больше не нужен.
* **Расширяемость без регрессий:** плагины — варианты enum, динамика отключаема в горячем пути.
* **MIT и прозрачность:** внедрение без юридических барьеров, стратегия «вперёд, не назад».

## Обзор архитектуры (уровень решения)

* **Рантайм:** собственный реактор и планировщик; совместимость с tokio — фича.
* **Маршрутизатор:** radix-trie со специфичностью по методу и пути, RCU-переключение версий.
* **Статика:** sendfile/mmap, кэши метаданных, precompressed-хинты.
* **Прокси:** неблокирующие клиенты, пулы, политика повторов и отсечки, балансировка.
* **Наблюдаемость:** JSON-логи, Prometheus, опциональный OpenTelemetry.
* **Безопасность:** rustls, ALPN, OCSP stapling, per-route mTLS, chroot/static-root, drop-privileges.

## Политика открытого исходника и экосистема

* **MIT:** свобода использования в продуктах и облаках, совместимость с корпоративными процессами.
* **Сообщество и партнёры:** прозрачный roadmap, RFC-процесс на ключевые изменения, «договор на стабильность» DSL.
* **Интеграции:** Helm-чарт, sidecar-паттерны, экспорт метрик и трасс в стандартные бэкенды.

## Стратегия внедрения

* **Пилот:** один продуктовый домен (SPA + API), равноправный A/B с текущим прокси, метрики и отчёт.
* **Расширение:** шаблоны конфигов, миграция статик-образов, унификация пайплайнов CI/CD.
* **Стандартизация:** базовые пресеты для команд, библиотеки конфиг-сниппетов, SRE-гайд по тюнингу.
* **Декомиссия старых решений:** план замены узлов, контроль рисков и регрессий, финальная инвентаризация.

## Метрики успеха

* **Скорость поставки:** от коммита до доступности SPA и API.
* **Надёжность:** частота и длительность инцидентов по сети и прокси-уровню.
* **Производительность:** стабильность задержек на высоких квантилях под нагрузкой.
* **Экономия:** снижение количества образов и сервисов в цепочке доставки, уменьшение расхода CPU/памяти.
* **Качество конфигов:** доля успешных hot-reload без ошибок, снижение «дребезга» правок.

## Риски и смягчения

* **Совместимость с легаси:** готовые адаптеры конфигов, режим токио-совместимости.
* **Неправильный тюнинг сети:** эталонные профили, чек-листы sysctl/ulimit, автоматические проверки.
* **Рост функциональной сложности:** продуктовые «гейт-фичи» по умолчанию выключены, hot path остаётся тонким.
* **Безопасность цепочки поставок:** воспроизводимые сборки, минимальный образ, вендоринг критичных либ.

## Дорожная карта (укрупнённо)

* **Основной этап:** ядро, DSL, fixed/echo, статика, прокси, встроенные плагины, метрики, hot-reload, контейнер.
* **Расширение:** балансировки и health-checks, h2c/gRPC passthrough, политика кэша и precompressed.
* **Производительность:** io_uring как опция, расширенные кэши и write-схемы, системные бенчи и гайды по тюнингу.

## Призыв к действию

* Утвердить AnyGate как стандартный прокси-слой для SPA и API в новых сервисах.
* Запустить пилот миграции на одном продукте с контролируемыми метриками.
* Зафиксировать корпоративные пресеты DSL и практики наблюдаемости.
* Сформировать общий план декомиссии устаревших конфигураций и образов.

## Что получит организация

* Единый, быстрый и прозрачный вход в цифровые продукты.
* Снижение сложности и затрат без потери контроля и безопасности.
* Предсказуемое масштабирование и ускорение релизов.
* Стандарт, который легко объяснить, внедрить и поддерживать.
